# ProGuard rules for MarketAlly.ViewEngine
# Prevents the Android linker from stripping critical WebView code

# Keep all WebView-related classes
-keep class android.webkit.** { *; }
-keep class **.WebView** { *; }
-keep class **.WebViewClient** { *; }
-keep class **.WebViewHandler** { *; }

# Keep all classes in the MarketAlly.Maui.ViewEngine namespace
-keep class MarketAlly.Maui.ViewEngine.** { *; }

# Keep all methods annotated with JavascriptInterface
-keepclassmembers class * {
    @android.webkit.JavascriptInterface <methods>;
}

# Keep JavaScript interface classes
-keep class MarketAlly.Maui.ViewEngine.WebViewHandler$WebViewJavaScriptInterface {
    public *;
}

# Keep custom WebViewClient
-keep class MarketAlly.Maui.ViewEngine.WebViewHandler$WebViewClient {
    public *;
}

# Keep download listener
-keep class MarketAlly.Maui.ViewEngine.CustomDownloadListener {
    public *;
}

# Keep PixelCopy listener
-keep class MarketAlly.Maui.ViewEngine.WebViewHandler$PixelCopyListener {
    public *;
}

# Keep ValueCallback
-keep class MarketAlly.Maui.ViewEngine.ValueCallback {
    public *;
}

# Keep all public methods in WebViewHandler
-keepclassmembers class MarketAlly.Maui.ViewEngine.WebViewHandler {
    public *;
}

# Preserve line numbers for debugging
-keepattributes SourceFile,LineNumberTable

# Keep generic signatures for reflection
-keepattributes Signature

# Keep annotations
-keepattributes *Annotation*
